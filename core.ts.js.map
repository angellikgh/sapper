{"version":3,"file":"core.ts.js","sources":["src/core/utils.ts","src/core/create_app.ts","src/core/create_serviceworker.ts","src/core/create_compilers.ts","src/core/create_routes.ts"],"sourcesContent":["import * as fs from 'fs';\n\nexport function write(file: string, code: string) {\n\tfs.writeFileSync(file, code);\n\tfudge_mtime(file);\n}\n\nexport function posixify(file: string) {\n\treturn file.replace(/[/\\\\]/g, '/');\n}\n\nexport function fudge_mtime(file: string) {\n\t// need to fudge the mtime so that webpack doesn't go doolally\n\tconst { atime, mtime } = fs.statSync(file);\n\tfs.utimesSync(\n\t\tfile,\n\t\tnew Date(atime.getTime() - 999999),\n\t\tnew Date(mtime.getTime() - 999999)\n\t);\n}","import * as fs from 'fs';\nimport * as path from 'path';\nimport mkdirp from 'mkdirp';\nimport create_routes from './create_routes';\nimport { fudge_mtime, posixify, write } from './utils';\nimport { dev } from '../config';\nimport { Route } from '../interfaces';\n\n// in dev mode, we avoid touching the fs unnecessarily\nlet last_client_manifest: string = null;\nlet last_server_manifest: string = null;\n\nexport default function create_app({ routes, dev_port }: {\n\troutes: Route[];\n\tdev_port: number;\n}) {\n\tmkdirp.sync('app/manifest');\n\n\tconst client_manifest = generate_client(routes, dev_port);\n\tconst server_manifest = generate_server(routes);\n\n\tif (client_manifest !== last_client_manifest) {\n\t\twrite(`app/manifest/client.js`, client_manifest);\n\t\tlast_client_manifest = client_manifest;\n\t}\n\n\tif (server_manifest !== last_server_manifest) {\n\t\twrite(`app/manifest/server.js`, server_manifest);\n\t\tlast_server_manifest = server_manifest;\n\t}\n}\n\nfunction generate_client(routes: Route[], dev_port?: number) {\n\tlet code = `\n\t\t// This file is generated by Sapper — do not edit it!\n\t\texport const routes = [\n\t\t\t${routes\n\t\t\t\t.map(route => {\n\t\t\t\t\tif (route.type !== 'page') {\n\t\t\t\t\t\treturn `{ pattern: ${route.pattern}, ignore: true }`;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst file = posixify(`../../routes/${route.file}`);\n\n\t\t\t\t\tif (route.id === '_4xx' || route.id === '_5xx') {\n\t\t\t\t\t\treturn `{ error: '${route.id.slice(1)}', load: () => import(/* webpackChunkName: \"${route.id}\" */ '${file}') }`;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst params = route.params.length === 0\n\t\t\t\t\t\t? '{}'\n\t\t\t\t\t\t: `{ ${route.params.map((part, i) => `${part}: match[${i + 1}]`).join(', ')} }`;\n\n\t\t\t\t\treturn `{ pattern: ${route.pattern}, params: ${route.params.length > 0 ? `match` : `()`} => (${params}), load: () => import(/* webpackChunkName: \"${route.id}\" */ '${file}') }`;\n\t\t\t\t})\n\t\t\t\t.join(',\\n\\t')}\n\t\t];`.replace(/^\\t\\t/gm, '').trim();\n\n\tif (dev()) {\n\t\tconst sapper_dev_client = posixify(\n\t\t\tpath.resolve(__dirname, 'sapper-dev-client.js')\n\t\t);\n\n\t\tcode += `\n\n\t\t\tif (module.hot) {\n\t\t\t\timport('${sapper_dev_client}').then(client => {\n\t\t\t\t\tclient.connect(${dev_port});\n\t\t\t\t});\n\t\t\t}`.replace(/^\\t{3}/gm, '');\n\t}\n\n\treturn code;\n}\n\nfunction generate_server(routes: Route[]) {\n\tlet code = `\n\t\t// This file is generated by Sapper — do not edit it!\n\t\t${routes\n\t\t\t.map(route => {\n\t\t\t\tconst file = posixify(`../../routes/${route.file}`);\n\t\t\t\treturn route.type === 'page'\n\t\t\t\t\t? `import ${route.id} from '${file}';`\n\t\t\t\t\t: `import * as ${route.id} from '${file}';`;\n\t\t\t})\n\t\t\t.join('\\n')}\n\n\t\texport const routes = [\n\t\t\t${routes\n\t\t\t\t.map(route => {\n\t\t\t\t\tconst file = posixify(`../../${route.file}`);\n\n\t\t\t\t\tif (route.id === '_4xx' || route.id === '_5xx') {\n\t\t\t\t\t\treturn `{ error: '${route.id.slice(1)}', module: ${route.id} }`;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst params = route.params.length === 0\n\t\t\t\t\t\t? '{}'\n\t\t\t\t\t\t: `{ ${route.params.map((part, i) => `${part}: match[${i + 1}]`).join(', ')} }`;\n\n\t\t\t\t\treturn `{ id: '${route.id}', type: '${route.type}', pattern: ${route.pattern}, params: ${route.params.length > 0 ? `match` : `()`} => (${params}), module: ${route.id} }`;\n\t\t\t\t})\n\t\t\t\t.join(',\\n\\t')\n\t\t\t}\n\t\t];`.replace(/^\\t\\t/gm, '').trim();\n\n\treturn code;\n}","import * as fs from 'fs';\nimport * as path from 'path';\nimport glob from 'glob';\nimport create_routes from './create_routes';\nimport { fudge_mtime, posixify, write } from './utils';\nimport { Route } from '../interfaces';\n\nexport default function create_serviceworker({ routes, client_files }: {\n\troutes: Route[];\n\tclient_files: string[];\n}) {\n\tconst assets = glob.sync('**', { cwd: 'assets', nodir: true });\n\n\tlet code = `\n\t\t// This file is generated by Sapper — do not edit it!\n\t\texport const timestamp = ${Date.now()};\n\n\t\texport const assets = [\\n\\t${assets.map((x: string) => `\"${x}\"`).join(',\\n\\t')}\\n];\n\n\t\texport const shell = [\\n\\t${client_files.map((x: string) => `\"${x}\"`).join(',\\n\\t')}\\n];\n\n\t\texport const routes = [\\n\\t${routes.filter((r: Route) => r.type === 'page' && !/^_[45]xx$/.test(r.id)).map((r: Route) => `{ pattern: ${r.pattern} }`).join(',\\n\\t')}\\n];\n\t`.replace(/^\\t\\t/gm, '').trim();\n\n\twrite('app/manifest/service-worker.js', code);\n}","import * as path from 'path';\nimport relative from 'require-relative';\n\nexport default function create_compilers() {\n\tconst webpack = relative('webpack', process.cwd());\n\n\tconst serviceworker_config = try_require(path.resolve('webpack/service-worker.config.js'));\n\n\treturn {\n\t\tclient: webpack(\n\t\t\trequire(path.resolve('webpack/client.config.js'))\n\t\t),\n\n\t\tserver: webpack(\n\t\t\trequire(path.resolve('webpack/server.config.js'))\n\t\t),\n\n\t\tserviceworker: serviceworker_config && webpack(serviceworker_config)\n\t};\n}\n\nfunction try_require(specifier: string) {\n\ttry {\n\t\treturn require(specifier);\n\t} catch (err) {\n\t\tif (err.code === 'MODULE_NOT_FOUND') return null;\n\t\tthrow err;\n\t}\n}","import * as path from 'path';\nimport glob from 'glob';\nimport { src } from '../config';\nimport { Route } from '../interfaces';\n\nexport default function create_routes({ files } = { files: glob.sync('**/*.*', { cwd: src(), nodir: true }) }) {\n\tconst routes: Route[] = files\n\t\t.map((file: string) => {\n\t\t\tif (/(^|\\/|\\\\)_/.test(file)) return;\n\n\t\t\tif (/]\\[/.test(file)) {\n\t\t\t\tthrow new Error(`Invalid route ${file} — parameters must be separated`);\n\t\t\t}\n\n\t\t\tconst base = file.replace(/\\.[^/.]+$/, '');\n\t\t\tconst parts = base.split('/'); // glob output is always posix-style\n\t\t\tif (parts[parts.length - 1] === 'index') parts.pop();\n\n\t\t\tconst id = (\n\t\t\t\tparts.join('_').replace(/[[\\]]/g, '$').replace(/^\\d/, '_$&').replace(/[^a-zA-Z0-9_$]/g, '_')\n\t\t\t ) || '_';\n\n\t\t\tconst params: string[] = [];\n\t\t\tconst param_pattern = /\\[([^\\]]+)\\]/g;\n\t\t\tlet match;\n\t\t\twhile (match = param_pattern.exec(base)) {\n\t\t\t\tparams.push(match[1]);\n\t\t\t}\n\n\t\t\t// TODO can we do all this with sub-parts? or does\n\t\t\t// nesting make that impossible?\n\t\t\tlet pattern_string = '';\n\t\t\tlet i = parts.length;\n\t\t\tlet nested = true;\n\t\t\twhile (i--) {\n\t\t\t\tconst part = encodeURIComponent(parts[i].normalize()).replace(/%5B/g, '[').replace(/%5D/g, ']');\n\t\t\t\tconst dynamic = ~part.indexOf('[');\n\n\t\t\t\tif (dynamic) {\n\t\t\t\t\tconst matcher = part.replace(param_pattern, `([^\\/]+?)`);\n\t\t\t\t\tpattern_string = nested ? `(?:\\\\/${matcher}${pattern_string})?` : `\\\\/${matcher}${pattern_string}`;\n\t\t\t\t} else {\n\t\t\t\t\tnested = false;\n\t\t\t\t\tpattern_string = `\\\\/${part}${pattern_string}`;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst pattern = new RegExp(`^${pattern_string}\\\\/?$`);\n\n\t\t\tconst test = (url: string) => pattern.test(url);\n\n\t\t\tconst exec = (url: string) => {\n\t\t\t\tconst match = pattern.exec(url);\n\t\t\t\tif (!match) return;\n\n\t\t\t\tconst result: Record<string, string> = {};\n\t\t\t\tparams.forEach((param, i) => {\n\t\t\t\t\tresult[param] = match[i + 1];\n\t\t\t\t});\n\n\t\t\t\treturn result;\n\t\t\t};\n\n\t\t\treturn {\n\t\t\t\tid,\n\t\t\t\ttype: path.extname(file) === '.html' ? 'page' : 'route',\n\t\t\t\tfile,\n\t\t\t\tpattern,\n\t\t\t\ttest,\n\t\t\t\texec,\n\t\t\t\tparts,\n\t\t\t\tparams\n\t\t\t};\n\t\t})\n\t\t.filter(Boolean)\n\t\t.sort((a: Route, b: Route) => {\n\t\t\tif (a.file === '4xx.html' || a.file === '5xx.html') return -1;\n\t\t\tif (b.file === '4xx.html' || b.file === '5xx.html') return 1;\n\n\t\t\tconst max = Math.max(a.parts.length, b.parts.length);\n\n\t\t\tfor (let i = 0; i < max; i += 1) {\n\t\t\t\tconst a_part = a.parts[i];\n\t\t\t\tconst b_part = b.parts[i];\n\n\t\t\t\tif (!a_part) return -1;\n\t\t\t\tif (!b_part) return 1;\n\n\t\t\t\tconst a_sub_parts = get_sub_parts(a_part);\n\t\t\t\tconst b_sub_parts = get_sub_parts(b_part);\n\t\t\t\tconst max = Math.max(a_sub_parts.length, b_sub_parts.length);\n\n\t\t\t\tfor (let i = 0; i < max; i += 1) {\n\t\t\t\t\tconst a_sub_part = a_sub_parts[i];\n\t\t\t\t\tconst b_sub_part = b_sub_parts[i];\n\n\t\t\t\t\tif (!a_sub_part) return 1; // b is more specific, so goes first\n\t\t\t\t\tif (!b_sub_part) return -1;\n\n\t\t\t\t\tif (a_sub_part.dynamic !== b_sub_part.dynamic) {\n\t\t\t\t\t\treturn a_sub_part.dynamic ? 1 : -1;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!a_sub_part.dynamic && a_sub_part.content !== b_sub_part.content) {\n\t\t\t\t\t\treturn b_sub_part.content.length - a_sub_part.content.length;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthrow new Error(`The ${a.file} and ${b.file} routes clash`);\n\t\t});\n\n\treturn routes;\n}\n\nfunction get_sub_parts(part: string) {\n\treturn part.split(/[\\[\\]]/)\n\t\t.map((content, i) => {\n\t\t\tif (!content) return null;\n\t\t\treturn {\n\t\t\t\tcontent,\n\t\t\t\tdynamic: i % 2 === 1\n\t\t\t};\n\t\t})\n\t\t.filter(Boolean);\n}"],"names":["fs.writeFileSync","fs.utimesSync","dev","path.resolve","path.extname"],"mappings":"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"}